module.exports=function(r){var n={};function i(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return r[t].call(e.exports,e,e.exports,i),e.l=!0,e.exports}return i.m=r,i.c=n,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,r){"use strict";r.r(e),r.d(e,"EE",function(){return w});var n=r(1),i=r(4),o=r(3),a=r.n(o),l=r(5),u=r.n(l),s=r(6),c=r(7),f=r.n(c),h=r(13),d=r(15);function y(t){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function v(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function p(o){return function(){var t,e,r,n=m(o);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var i=m(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return e=this,!(r=t)||"object"!==y(r)&&"function"!=typeof r?g(e):r}}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function b(t,e){return(b=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var w=new a.a,x=new i.default("imgPool"),k=new i.default("canvasPool"),S={view:d.View,text:d.Text,image:d.Image,scrollview:d.ScrollView,bitmaptext:d.BitMapText};function T(t,n,i){t.forEach(function(e){var r=n.find(function(t){return t.id===e.id});r.realLayoutBox=r.realLayoutBox||{},["left","top","width","height"].forEach(function(t){r.realLayoutBox[t]=e.layout[t]*i}),r.parent?(r.realLayoutBox.realX=(r.parent.realLayoutBox.realX||0)+r.realLayoutBox.left,Object.defineProperty(r.realLayoutBox,"realY",{configurable:!0,enumerable:!0,get:function(){var t=(r.parent.realLayoutBox.realY||0)+r.realLayoutBox.top;return r.parent&&"ScrollView"===r.parent.type&&(t-=r.parent.top*i),t}})):(r.realLayoutBox.realX=r.realLayoutBox.left,r.realLayoutBox.realY=r.realLayoutBox.top),T(e.children,r.children,i)})}var O=new(function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&b(t,e)}(o,n["default"]);var t,e,r,i=p(o);function o(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=e.style,n=e.name;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this,{style:r,id:0,name:n})).hasEventHandler=!1,t.elementTree=null,t.renderContext=null,t.debugInfo={},t.renderport={},t.viewport={},t.touchStart=t.eventHandler("touchstart").bind(g(t)),t.touchMove=t.eventHandler("touchmove").bind(g(t)),t.touchEnd=t.eventHandler("touchend").bind(g(t)),t.touchCancel=t.eventHandler("touchcancel").bind(g(t)),t.version="0.0.1",t.touchMsg={},t.hasViewPortSet=!1,t.realLayoutBox={realX:0,realY:0},t.state=s.STATE.UNINIT,t.bitMapFonts=[],t}return t=o,(e=[{key:"updateViewPort",value:function(t){var e=JSON.stringify(this.viewport);this.viewport.width=t.width||0,this.viewport.height=t.height||0,this.viewport.x=t.x||0,this.viewport.y=t.y||0,this.realLayoutBox={realX:this.viewport.x,realY:this.viewport.y},this.hasViewPortSet=!0,e!==JSON.stringify(this.viewport)&&this.renderport&&this.elementTree&&this.children&&T(this.elementTree.children,this.children,this.viewport.width/this.renderport.width)}},{key:"init",value:function(t,e,r){var n=new Date,i={attributeNamePrefix:"",attrNodeName:"attr",textNodeName:"#text",ignoreAttributes:!1,ignoreNameSpace:!0,allowBooleanAttributes:!0,parseNodeValue:!1,parseAttributeValue:!1,trimValues:!0,parseTrueNumberOnly:!1};r&&"function"==typeof r&&(i.attrValueProcessor=r);var o=f.a.parse(t,i,!0).children[0];this.debugInfo.xmlTree=new Date-n,this.layoutTree=function r(t,i){var n=this,e=S[t.name],o=t.children||[],a=t.attr||{},l=a.id||"",u=Object.keys(a).reduce(function(t,e){var r=a[e],n=e;return"id"===e?t.style=Object.assign(t.style||{},i[l]||{}):"class"===e?t.style=r.split(/\s+/).reduce(function(t,e){return Object.assign(t,i[e])},t.style||{}):t[n]="true"===r||"false"!==r&&r,t},{});u.idName=l,u.className=a.class||"";var s=new e(u);return s.root=this,o.forEach(function(t){var e=r.call(n,t,i);s.add(e)}),s}.call(this,o,e),this.debugInfo.layoutTree=new Date-n,this.add(this.layoutTree);var a={id:this.id,style:{width:this.style.width,height:this.style.height,flexDirection:"row"},children:function e(r){return Object.keys(r.children).map(function(t){return r.children[t]}).map(function(t){return{id:t.id,name:t.name,style:t.style,children:e(t)}})}(this)};u()(a),this.elementTree=a,this.debugInfo.renderTree=new Date-n;var l=this.children[0];void 0===l.style.width||void 0===l.style.height?console.error("Please set width and height property for root element"):(this.renderport.width=l.style.width,this.renderport.height=l.style.height),this.state=s.STATE.INITED}},{key:"layout",value:function(t){var e=new Date;this.renderContext=t,this.renderContext&&this.renderContext.clearRect(0,0,this.renderport.width,this.renderport.height),this.hasViewPortSet||console.error("Please invoke method `updateViewPort` before method `layout`"),function t(e,n){var i=this;e.forEach(function(e){var r=n.find(function(t){return t.id===e.id});r.layoutBox=r.layoutBox||{},["left","top","width","height"].forEach(function(t){r.layoutBox[t]=e.layout[t]}),r.parent?(r.layoutBox.absoluteX=(r.parent.layoutBox.absoluteX||0)+r.layoutBox.left,r.layoutBox.absoluteY=(r.parent.layoutBox.absoluteY||0)+r.layoutBox.top):(r.layoutBox.absoluteX=r.layoutBox.left,r.layoutBox.absoluteY=r.layoutBox.top),r.layoutBox.originalAbsoluteY=r.layoutBox.absoluteY,"ScrollView"===r.type&&r.updateRenderPort(i.renderport),t.call(i,e.children,r.children)})}.call(this,this.elementTree.children,this.children),this.debugInfo.layoutChildren=new Date-e,T(this.elementTree.children,this.children,this.viewport.width/this.renderport.width),this.debugInfo.updateRealLayout=new Date-e,function r(t,n,i){t.map(function(e){var t=n.find(function(t){return t.id===e.id});if("ScrollView"!==t.type)return t.insert(i),r(e.children,t.children,i);t.insertScrollView(i)})}(this.elementTree.children,this.children,t),this.debugInfo.renderChildren=new Date-e,this.bindEvents(),this.state=s.STATE.RENDERED}},{key:"getChildByPos",value:function(t,e,r){for(var n=Object.keys(t.children),i=0;i<n.length;i++){var o=t.children[n[i]],a=o.realLayoutBox;if(a.realX<=e&&e<=a.realX+a.width&&a.realY<=r&&r<=a.realY+a.height)return Object.keys(o.children).length?this.getChildByPos(o,e,r):o}return t}},{key:"eventHandler",value:function(n){return function(t){if(this.elementTree){var e=t.touches&&t.touches[0]||t.changedTouches&&t.changedTouches[0]||t;if(e&&e.pageX&&e.pageY){e.timeStamp||(e.timeStamp=t.timeStamp);var r=e&&this.getChildByPos(this,e.pageX,e.pageY);r&&r.emit(n,t),"touchstart"!==n&&"touchend"!==n||(this.touchMsg[n]=e),"touchend"===n&&Object(s.isClick)(this.touchMsg)&&r&&r.emit("click",t)}}}}},{key:"bindEvents",value:function(){this.hasEventHandler||(this.hasEventHandler=!0,"undefined"!=typeof wx?(wx.onTouchStart(this.touchStart),wx.onTouchMove(this.touchMove),wx.onTouchEnd(this.touchEnd),wx.onTouchCancel(this.touchCancel)):(document.onmousedown=this.touchStart,document.onmousemove=this.touchMove,document.onmouseup=this.touchEnd,document.onmouseleave=this.touchEnd))}},{key:"emit",value:function(t,e){w.emit(t,e)}},{key:"on",value:function(t,e){w.on(t,e)}},{key:"once",value:function(t,e){w.once(t,e)}},{key:"off",value:function(t,e){w.off(t,e)}},{key:"getElementsById",value:function(t){return function r(n,t,e){var i=1<arguments.length&&void 0!==t?t:[],o=2<arguments.length?e:void 0;return Object.keys(n.children).forEach(function(t){var e=n.children[t];e.idName===o&&i.push(e),Object.keys(e.children).length&&r(e,i,o)}),i}(this,[],t)}},{key:"getElementsByClassName",value:function(t){return function r(n,t,e){var i=1<arguments.length&&void 0!==t?t:[],o=2<arguments.length?e:void 0;return Object.keys(n.children).forEach(function(t){var e=n.children[t];-1<e.className.split(/\s+/).indexOf(o)&&i.push(e),Object.keys(e.children).length&&r(e,i,o)}),i}(this,[],t)}},{key:"destroyAll",value:function(t){var r=this,n=(t=t||this).children;Object.keys(n).forEach(function(t){var e=n[t];e.destroy(),r.destroyAll(e),e.destroySelf&&e.destroySelf()})}},{key:"clear",value:function(){var e=this;this.destroyAll(),this.elementTree=null,this.children=[],this.layoutTree={},this.state=s.STATE.CLEAR,Object.keys(k.pool).forEach(function(t){var e=k.get(t);e.context&&e.context.clearRect(0,0,e.canvas.width,e.canvas.height),e.elements=[],e.canvas=null,e.context=null}),this.renderContext&&this.renderContext.clearRect(0,0,this.renderContext.canvas.width,this.renderContext.canvas.height),["touchstart","touchmove","touchcancel","touchend","click","repaint"].forEach(function(t){e.off(t)}),this.EE.off("image__render__done")}},{key:"clearPool",value:function(){x.clear(),k.clear()}},{key:"clearAll",value:function(){this.clear(),this.clearPool()}},{key:"loadImgs",value:function(t){t.forEach(function(t){var e=Object(s.createImage)();x.set(t,e),e.onload=function(){e.loadDone=!0},e.onloadcbks=[],e.src=t})}},{key:"registBitMapFont",value:function(t,e,r){var n=new h.default(t,e,r);this.bitMapFonts.push(n)}}])&&v(t.prototype,e),r&&v(t,r),o}())({style:{width:0,height:0},name:"layout"});e.default=O},function(t,e,r){"use strict";r.r(e),r.d(e,"default",function(){return o});var y=r(2);function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var v=new(r(3)),p=0;function g(t,e){var r,n=(r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t))?{r:parseInt(r[1],16),g:parseInt(r[2],16),b:parseInt(r[3],16)}:null;return null==e&&(e=1),"rgba(".concat(n.r,", ").concat(n.g,", ").concat(n.b,", ").concat(e,")")}function i(t,e){return["click","touchstart","touchmove","touchend","touchcancel"].indexOf(t),"element-".concat(e,"-").concat(t)}var o=function(){function d(t){var n=this,e=t.style,r=void 0===e?{}:e,i=t.props,o=void 0===i?{}:i,a=t.idName,l=void 0===a?"":a,u=t.className,s=void 0===u?"":u,c=t.id,f=void 0===c?++p:c;for(var h in!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),this.children=[],this.parent=null,this.parentId=0,this.id=f,this.props=o,this.idName=l,this.className=s,this.style=r,this.EE=v,this.root=null,this.isDestroyed=!1,this.layoutBox={},void 0!==r.opacity&&r.color&&-1<r.color.indexOf("#")&&(r.color=g(r.color,r.opacity)),void 0!==r.opacity&&r.backgroundColor&&-1<r.backgroundColor.indexOf("#")&&(r.backgroundColor=g(r.backgroundColor,r.opacity)),this.style)-1<y.scalableStyles.indexOf(h)&&(this.style[h]*=1);["touchstart","touchmove","touchcancel","touchend","click"].forEach(function(r){n.on(r,function(t,e){n.parent&&n.parent.emit(r,t,e)})}),this.initRepaint()}var t,e,r;return t=d,(e=[{key:"initRepaint",value:function(){var e=this;this.on("repaint",function(t){e.parent&&e.parent.emit("repaint",t)})}},{key:"repaint",value:function(){}},{key:"insert",value:function(){}},{key:"checkNeedRender",value:function(){return!0}},{key:"destroy",value:function(){var e=this;["touchstart","touchmove","touchcancel","touchend","click","repaint"].forEach(function(t){e.off(t)}),this.EE.off("image__render__done"),this.isDestroyed=!0,this.EE=null,this.root=null,this.parent=null,this.ctx=null,this.realLayoutBox=null,this.layoutBox=null,this.props=null,this.style=null,this.renderBoxes&&(this.renderBoxes=null)}},{key:"add",value:function(t){t.parent=this,t.parentId=this.id,this.children.push(t)}},{key:"emit",value:function(t){for(var e=arguments.length,r=new Array(1<e?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];v.emit.apply(v,[i(t,this.id)].concat(r))}},{key:"on",value:function(t,e){v.on(i(t,this.id),e)}},{key:"once",value:function(t,e){v.once(i(t,this.id),e)}},{key:"off",value:function(t,e){v.off(i(t,this.id),e)}},{key:"roundRect",value:function(t,e){var r=this.style||{},n=e||this.layoutBox,i=n.width,o=n.height,a=r.borderRadius,l=n.absoluteX,u=n.absoluteY;t.moveTo(l+a,u),t.arcTo(l+i,u,l+i,u+o,a),t.arcTo(l+i,u+o,l,u+o,a),t.arcTo(l,u+o,l,u,a),t.arcTo(l,u,l+i,u,a),t.clip()}},{key:"renderBorder",value:function(t,e){var r=this.style||{};r.borderRadius&&this.roundRect(t,e),t.save();var n=e||this.layoutBox,i=r.borderWidth||0,o=r.borderLeftWidth||0,a=r.borderRightWidth||0,l=r.borderTopWidth||0,u=r.borderBottomWidth||0,s=r.borderRadius||0,c=r.borderColor,f=n.absoluteX,h=n.absoluteY;t.beginPath(),i&&c&&(t.lineWidth=i,t.strokeStyle=c,t.strokeRect(f,h,n.width,n.height)),l&&(c||r.borderTopColor)&&(t.lineWidth=l,t.strokeStyle=r.borderTopColor||c,t.moveTo(s?f+s:f,h+l/2),t.lineTo(s?f+n.width-s:f+n.width,h+l/2)),u&&(c||r.borderBottomColor)&&(t.lineWidth=u,t.strokeStyle=r.borderBottomColor||c,t.moveTo(s?f+s:f,h+n.height-u/2),t.lineTo(s?f+n.width-s:f+n.width,h+n.height-u/2)),o&&(c||r.borderLeftColor)&&(t.lineWidth=o,t.strokeStyle=r.borderLeftColor||c,t.moveTo(f+o/2,s?h+s:h),t.lineTo(f+o/2,s?h+n.height-s:h+n.height)),a&&(c||r.borderRightColor)&&(t.lineWidth=a,t.strokeStyle=r.borderRightColor||c,t.moveTo(f+n.width-a/2,s?h+s:h),t.lineTo(f+n.width-a/2,s?h+n.height-s:h+n.height)),t.closePath(),t.stroke(),t.restore()}}])&&n(t.prototype,e),r&&n(t,r),d}()},function(t,e,r){"use strict";r.r(e),r.d(e,"scalableStyles",function(){return i}),r.d(e,"textStyles",function(){return n}),r.d(e,"layoutAffectedStyles",function(){return o});var n=["color","fontSize","textAlign","fontWeight","lineHeight","lineBreak"],i=["left","top","right","bottom","width","height","margin","marginLeft","marginRight","marginTop","marginBottom","padding","paddingLeft","paddingRight","paddingTop","paddingBottom","fontSize","lineHeight","borderRadius","minWidth","maxWidth","minHeight","maxHeight"],o=["margin","marginTop","marginBottom","marginLeft","marginRight","padding","paddingTop","paddingBottom","paddingLeft","paddingRight","width","height"]},function(t,e){function r(){}r.prototype={on:function(t,e,r){var n=this.e||(this.e={});return(n[t]||(n[t]=[])).push({fn:e,ctx:r}),this},once:function(t,e,r){var n=this;function i(){n.off(t,i),e.apply(r,arguments)}return i._=e,this.on(t,i,r)},emit:function(t){for(var e=[].slice.call(arguments,1),r=((this.e||(this.e={}))[t]||[]).slice(),n=0,i=r.length;n<i;n++)r[n].fn.apply(r[n].ctx,e);return this},off:function(t,e){var r=this.e||(this.e={}),n=r[t],i=[];if(n&&e)for(var o=0,a=n.length;o<a;o++)n[o].fn!==e&&n[o].fn._!==e&&i.push(n[o]);return i.length?r[t]=i:delete r[t],this}},t.exports=r,t.exports.TinyEmitter=r},function(t,e,r){"use strict";function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}r.r(e),r.d(e,"default",function(){return n});var o=[],n=function(){function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"pool";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);var t=o.find(function(t){return t.name===e});if(t)return t;this.name=e,this.pool={},o.push(this)}var t,e,n;return t=r,(e=[{key:"get",value:function(t){return this.pool[t]}},{key:"set",value:function(t,e){this.pool[t]=e}},{key:"clear",value:function(){this.pool={}}}])&&i(t.prototype,e),n&&i(t,n),r}()},function(t,e,r){var n,i,o;i=[],void 0===(o="function"==typeof(n=function(){var e=function(){var mt;var n="inherit";var o="ltr";var r="rtl";var bt="row";var wt="row-reverse";var xt="column";var kt="column-reverse";var St="flex-start";var Tt="center";var Ot="flex-end";var Et="space-between";var Bt="space-around";var Ct="flex-start";var Rt="center";var Nt="flex-end";var Pt="stretch";var _t="relative";var jt="absolute";var It={row:"left","row-reverse":"right",column:"top","column-reverse":"bottom"};var At={row:"right","row-reverse":"left",column:"bottom","column-reverse":"top"};var Lt={row:"left","row-reverse":"right",column:"top","column-reverse":"bottom"};var Mt={row:"width","row-reverse":"width",column:"height","column-reverse":"height"};function e(t){if(!t.layout||t.isDirty){t.layout={width:undefined,height:undefined,top:0,left:0,right:0,bottom:0}}if(!t.style){t.style={}}if(!t.children){t.children=[]}t.children.forEach(e);return t}function Dt(t){return t===undefined}function Wt(t){return t===bt||t===wt}function i(t){return t===xt||t===kt}function Ht(t,e){if(t.style.marginStart!==undefined&&Wt(e)){return t.style.marginStart}var r=null;switch(e){case"row":r=t.style.marginLeft;break;case"row-reverse":r=t.style.marginRight;break;case"column":r=t.style.marginTop;break;case"column-reverse":r=t.style.marginBottom;break}if(r!==undefined){return r}if(t.style.margin!==undefined){return t.style.margin}return 0}function Yt(t,e){if(t.style.marginEnd!==undefined&&Wt(e)){return t.style.marginEnd}var r=null;switch(e){case"row":r=t.style.marginRight;break;case"row-reverse":r=t.style.marginLeft;break;case"column":r=t.style.marginBottom;break;case"column-reverse":r=t.style.marginTop;break}if(r!=null){return r}if(t.style.margin!==undefined){return t.style.margin}return 0}function a(t,e){if(t.style.paddingStart!==undefined&&t.style.paddingStart>=0&&Wt(e)){return t.style.paddingStart}var r=null;switch(e){case"row":r=t.style.paddingLeft;break;case"row-reverse":r=t.style.paddingRight;break;case"column":r=t.style.paddingTop;break;case"column-reverse":r=t.style.paddingBottom;break}if(r!=null&&r>=0){return r}if(t.style.padding!==undefined&&t.style.padding>=0){return t.style.padding}return 0}function l(t,e){if(t.style.paddingEnd!==undefined&&t.style.paddingEnd>=0&&Wt(e)){return t.style.paddingEnd}var r=null;switch(e){case"row":r=t.style.paddingRight;break;case"row-reverse":r=t.style.paddingLeft;break;case"column":r=t.style.paddingBottom;break;case"column-reverse":r=t.style.paddingTop;break}if(r!=null&&r>=0){return r}if(t.style.padding!==undefined&&t.style.padding>=0){return t.style.padding}return 0}function Vt(t,e){if(t.style.borderStartWidth!==undefined&&t.style.borderStartWidth>=0&&Wt(e)){return t.style.borderStartWidth}var r=null;switch(e){case"row":r=t.style.borderLeftWidth;break;case"row-reverse":r=t.style.borderRightWidth;break;case"column":r=t.style.borderTopWidth;break;case"column-reverse":r=t.style.borderBottomWidth;break}if(r!=null&&r>=0){return r}if(t.style.borderWidth!==undefined&&t.style.borderWidth>=0){return t.style.borderWidth}return 0}function u(t,e){if(t.style.borderEndWidth!==undefined&&t.style.borderEndWidth>=0&&Wt(e)){return t.style.borderEndWidth}var r=null;switch(e){case"row":r=t.style.borderRightWidth;break;case"row-reverse":r=t.style.borderLeftWidth;break;case"column":r=t.style.borderBottomWidth;break;case"column-reverse":r=t.style.borderTopWidth;break}if(r!=null&&r>=0){return r}if(t.style.borderWidth!==undefined&&t.style.borderWidth>=0){return t.style.borderWidth}return 0}function Xt(t,e){return a(t,e)+Vt(t,e)}function Ft(t,e){return l(t,e)+u(t,e)}function Kt(t,e){return Vt(t,e)+u(t,e)}function zt(t,e){return Ht(t,e)+Yt(t,e)}function qt(t,e){return Xt(t,e)+Ft(t,e)}function Gt(t){if(t.style.justifyContent){return t.style.justifyContent}return"flex-start"}function Jt(t){if(t.style.alignContent){return t.style.alignContent}return"flex-start"}function Ut(t,e){if(e.style.alignSelf){return e.style.alignSelf}if(t.style.alignItems){return t.style.alignItems}return"stretch"}function $t(t,e){if(e===r){if(t===bt){return wt}else if(t===wt){return bt}}return t}function Zt(t,e){var r;if(t.style.direction){r=t.style.direction}else{r=n}if(r===n){r=e===undefined?o:e}return r}function Qt(t){if(t.style.flexDirection){return t.style.flexDirection}return xt}function te(t,e){if(i(t)){return $t(bt,e)}else{return xt}}function ee(t){if(t.style.position){return t.style.position}return"relative"}function re(t){return ee(t)===_t&&t.style.flex>0}function ne(t){return t.style.flexWrap==="wrap"}function ie(t,e){return t.layout[Mt[e]]+zt(t,e)}function oe(t,e){return t.style[Mt[e]]!==undefined&&t.style[Mt[e]]>=0}function ae(t,e){return t.style[e]!==undefined}function le(t){return t.style.measure!==undefined}function ue(t,e){if(t.style[e]!==undefined){return t.style[e]}return 0}function se(t,e,r){var n={row:t.style.minWidth,"row-reverse":t.style.minWidth,column:t.style.minHeight,"column-reverse":t.style.minHeight}[e];var i={row:t.style.maxWidth,"row-reverse":t.style.maxWidth,column:t.style.maxHeight,"column-reverse":t.style.maxHeight}[e];var o=r;if(i!==undefined&&i>=0&&o>i){o=i}if(n!==undefined&&n>=0&&o<n){o=n}return o}function ce(t,e){if(t>e){return t}return e}function fe(t,e){if(t.layout[Mt[e]]!==undefined){return}if(!oe(t,e)){return}t.layout[Mt[e]]=ce(se(t,e,t.style[Mt[e]]),qt(t,e))}function he(t,e,r){e.layout[At[r]]=t.layout[Mt[r]]-e.layout[Mt[r]]-e.layout[Lt[r]]}function de(t,e){if(t.style[It[e]]!==undefined){return ue(t,It[e])}return-ue(t,At[e])}function s(t,e,r){var n=Zt(t,r);var i=$t(Qt(t),n);var o=te(i,n);var a=$t(bt,n);fe(t,i);fe(t,o);t.layout.direction=n;t.layout[It[i]]+=Ht(t,i)+de(t,i);t.layout[At[i]]+=Yt(t,i)+de(t,i);t.layout[It[o]]+=Ht(t,o)+de(t,o);t.layout[At[o]]+=Yt(t,o)+de(t,o);var l=t.children.length;var u=qt(t,a);if(le(t)){var s=!Dt(t.layout[Mt[a]]);var c=mt;if(oe(t,a)){c=t.style.width}else if(s){c=t.layout[Mt[a]]}else{c=e-zt(t,a)}c-=u;var f=!oe(t,a)&&!s;var h=!oe(t,xt)&&Dt(t.layout[Mt[xt]]);if(f||h){var d=t.style.measure(c);if(f){t.layout.width=d.width+u}if(h){t.layout.height=d.height+qt(t,xt)}}if(l===0){return}}var y=ne(t);var v=Gt(t);var p=Xt(t,i);var g=Xt(t,o);var m=qt(t,i);var b=qt(t,o);var w=!Dt(t.layout[Mt[i]]);var x=!Dt(t.layout[Mt[o]]);var k=Wt(i);var S;var T;var O;var E;var B=null;var C=null;var R=mt;if(w){R=t.layout[Mt[i]]-m}var N=0;var P=0;var _=0;var j=0;var I=0;var A=0;while(P<l){var L=0;var M=0;var D=0;var W=0;var H=w&&v===St||!w&&v!==Tt;var Y=H?l:N;var V=true;var X=l;var F=null;var K=null;var z=p;var q=0;var G;for(S=N;S<l;++S){O=t.children[S];O.lineIndex=A;O.nextAbsoluteChild=null;O.nextFlexChild=null;var J=Ut(t,O);if(J===Pt&&ee(O)===_t&&x&&!oe(O,o)){O.layout[Mt[o]]=ce(se(O,o,t.layout[Mt[o]]-b-zt(O,o)),qt(O,o))}else if(ee(O)===jt){if(B===null){B=O}if(C!==null){C.nextAbsoluteChild=O}C=O;for(T=0;T<2;T++){E=T!==0?bt:xt;if(!Dt(t.layout[Mt[E]])&&!oe(O,E)&&ae(O,It[E])&&ae(O,At[E])){O.layout[Mt[E]]=ce(se(O,E,t.layout[Mt[E]]-qt(t,E)-zt(O,E)-ue(O,It[E])-ue(O,At[E])),qt(O,E))}}}var U=0;if(w&&re(O)){M++;D+=O.style.flex;if(F===null){F=O}if(K!==null){K.nextFlexChild=O}K=O;U=qt(O,i)+zt(O,i)}else{G=mt;if(!k){if(oe(t,a)){G=t.layout[Mt[a]]-u}else{G=e-zt(t,a)-u}}if(_===0){ye(O,G,n)}if(ee(O)===_t){W++;U=ie(O,i)}}if(y&&w&&L+U>R&&S!==N){W--;_=1;break}if(H&&(ee(O)!==_t||re(O))){H=false;Y=S}if(V&&(ee(O)!==_t||J!==Pt&&J!==Ct||Dt(O.layout[Mt[o]]))){V=false;X=S}if(H){O.layout[Lt[i]]+=z;if(w){he(t,O,i)}z+=ie(O,i);q=ce(q,se(O,o,ie(O,o)))}if(V){O.layout[Lt[o]]+=j+g;if(x){he(t,O,o)}}_=0;L+=U;P=S+1}var $=0;var Z=0;var Q=0;if(w){Q=R-L}else{Q=ce(L,0)-L}if(M!==0){var tt=Q/D;var et;var rt;K=F;while(K!==null){et=tt*K.style.flex+qt(K,i);rt=se(K,i,et);if(et!==rt){Q-=rt;D-=K.style.flex}K=K.nextFlexChild}tt=Q/D;if(tt<0){tt=0}K=F;while(K!==null){K.layout[Mt[i]]=se(K,i,tt*K.style.flex+qt(K,i));G=mt;if(oe(t,a)){G=t.layout[Mt[a]]-u}else if(!k){G=e-zt(t,a)-u}ye(K,G,n);O=K;K=K.nextFlexChild;O.nextFlexChild=null}}else if(v!==St){if(v===Tt){$=Q/2}else if(v===Ot){$=Q}else if(v===Et){Q=ce(Q,0);if(M+W-1!==0){Z=Q/(M+W-1)}else{Z=0}}else if(v===Bt){Z=Q/(M+W);$=Z/2}}z+=$;for(S=Y;S<P;++S){O=t.children[S];if(ee(O)===jt&&ae(O,It[i])){O.layout[Lt[i]]=ue(O,It[i])+Vt(t,i)+Ht(O,i)}else{O.layout[Lt[i]]+=z;if(w){he(t,O,i)}if(ee(O)===_t){z+=Z+ie(O,i);q=ce(q,se(O,o,ie(O,o)))}}}var nt=t.layout[Mt[o]];if(!x){nt=ce(se(t,o,q+b),b)}for(S=X;S<P;++S){O=t.children[S];if(ee(O)===jt&&ae(O,It[o])){O.layout[Lt[o]]=ue(O,It[o])+Vt(t,o)+Ht(O,o)}else{var it=g;if(ee(O)===_t){var J=Ut(t,O);if(J===Pt){if(Dt(O.layout[Mt[o]])){O.layout[Mt[o]]=ce(se(O,o,nt-b-zt(O,o)),qt(O,o))}}else if(J!==Ct){var ot=nt-b-ie(O,o);if(J===Rt){it+=ot/2}else{it+=ot}}}O.layout[Lt[o]]+=j+it;if(x){he(t,O,o)}}}j+=q;I=ce(I,z);A+=1;N=P}if(A>1&&x){var at=t.layout[Mt[o]]-b;var lt=at-j;var ut=0;var st=g;var ct=Jt(t);if(ct===Nt){st+=lt}else if(ct===Rt){st+=lt/2}else if(ct===Pt){if(at>j){ut=lt/A}}var ft=0;for(S=0;S<A;++S){var ht=ft;var dt=0;for(T=ht;T<l;++T){O=t.children[T];if(ee(O)!==_t){continue}if(O.lineIndex!==S){break}if(!Dt(O.layout[Mt[o]])){dt=ce(dt,O.layout[Mt[o]]+zt(O,o))}}ft=T;dt+=ut;for(T=ht;T<ft;++T){O=t.children[T];if(ee(O)!==_t){continue}var yt=Ut(t,O);if(yt===Ct){O.layout[Lt[o]]=st+Ht(O,o)}else if(yt===Nt){O.layout[Lt[o]]=st+dt-Yt(O,o)-O.layout[Mt[o]]}else if(yt===Rt){var vt=O.layout[Mt[o]];O.layout[Lt[o]]=st+(dt-vt)/2}else if(yt===Pt){O.layout[Lt[o]]=st+Ht(O,o)}}st+=dt}}var pt=false;var gt=false;if(!w){t.layout[Mt[i]]=ce(se(t,i,I+Ft(t,i)),m);if(i===wt||i===kt){pt=true}}if(!x){t.layout[Mt[o]]=ce(se(t,o,j+b),b);if(o===wt||o===kt){gt=true}}if(pt||gt){for(S=0;S<l;++S){O=t.children[S];if(pt){he(t,O,i)}if(gt){he(t,O,o)}}}C=B;while(C!==null){for(T=0;T<2;T++){E=T!==0?bt:xt;if(!Dt(t.layout[Mt[E]])&&!oe(C,E)&&ae(C,It[E])&&ae(C,At[E])){C.layout[Mt[E]]=ce(se(C,E,t.layout[Mt[E]]-Kt(t,E)-zt(C,E)-ue(C,It[E])-ue(C,At[E])),qt(C,E))}if(ae(C,At[E])&&!ae(C,It[E])){C.layout[It[E]]=t.layout[Mt[E]]-C.layout[Mt[E]]-ue(C,At[E])}}O=C;C=C.nextAbsoluteChild;O.nextAbsoluteChild=null}}function ye(t,e,r){t.shouldUpdate=true;var n=t.style.direction||o;var i=!t.isDirty&&t.lastLayout&&t.lastLayout.requestedHeight===t.layout.height&&t.lastLayout.requestedWidth===t.layout.width&&t.lastLayout.parentMaxWidth===e&&t.lastLayout.direction===n;if(i){t.layout.width=t.lastLayout.width;t.layout.height=t.lastLayout.height;t.layout.top=t.lastLayout.top;t.layout.left=t.lastLayout.left}else{if(!t.lastLayout){t.lastLayout={}}t.lastLayout.requestedWidth=t.layout.width;t.lastLayout.requestedHeight=t.layout.height;t.lastLayout.parentMaxWidth=e;t.lastLayout.direction=n;t.children.forEach(function(t){t.layout.width=undefined;t.layout.height=undefined;t.layout.top=0;t.layout.left=0});s(t,e,r);t.lastLayout.width=t.layout.width;t.lastLayout.height=t.layout.height;t.lastLayout.top=t.layout.top;t.lastLayout.left=t.layout.left}}return{layoutNodeImpl:s,computeLayout:ye,fillNodes:e}}();if(true){t.exports=e}return function(t){e.fillNodes(t);e.computeLayout(t)}})?n.apply(e,i):n)||(t.exports=o)},function(t,e,r){"use strict";function n(n,i,o){var a,l;return i=i||250,function(){var t=o||this,e=+new Date,r=arguments;a&&e<a+i?(clearTimeout(l),l=setTimeout(function(){a=e,n.apply(t,r)},i)):(a=e,n.apply(t,r))}}function i(){}function o(t){var e=t.touchstart,r=t.touchend;if(!(e&&r&&e.timeStamp&&r.timeStamp&&void 0!==e.pageX&&void 0!==e.pageY&&void 0!==r.pageX&&void 0!==r.pageY))return!1;var n=e.pageX,i=e.pageY,o=r.pageX,a=r.pageY,l=r.timeStamp-e.timeStamp;return!!(Math.abs(a-i)<30&&Math.abs(o-n)<30&&l<300)}function a(){return"undefined"!=typeof wx?wx.createCanvas():document.createElement("canvas")}function l(){return"undefined"!=typeof wx?wx.createImage():document.createElement("img")}function u(){return"undefined"!=typeof wx?wx.getSystemInfoSync().devicePixelRatio:window.devicePixelRatio}r.r(e),r.d(e,"throttle",function(){return n}),r.d(e,"none",function(){return i}),r.d(e,"isClick",function(){return o}),r.d(e,"createCanvas",function(){return a}),r.d(e,"createImage",function(){return l}),r.d(e,"getDpr",function(){return u}),r.d(e,"STATE",function(){return s});var s={UNINIT:0,INITED:1,RENDERED:2,CLEAR:3}},function(t,e,r){"use strict";var i=r(8),o=r(10),a=r(10),l=r(9).buildOptions,u=r(12);e.parse=function(t,e,r){if(r){!0===r&&(r={});var n=u.validate(t,r);if(!0!==n)throw Error(n.err.msg)}return e=l(e,a.defaultOptions,a.props),i.convertToJson(o.getTraversalObj(t,e),e)}},function(t,e,r){"use strict";var i=r(9);e.convertToJson=function e(t,r){var n={name:t.tagname};return t.child&&!i.isEmptyObject(t.child)||t.attrsMap&&!i.isEmptyObject(t.attrsMap)?(i.isExist(t.val)&&("string"!=typeof t.val||""!==t.val&&t.val!==r.cdataPositionChar)&&("strict"===r.arrayMode?n[r.textNodeName]=[t.val]:n[r.textNodeName]=t.val),i.merge(n,t.attrsMap,r.arrayMode),n.children=[],t.children.forEach(function(t){n.children.push(e(t,r))}),n):i.isExist(t.val)&&t.val?t.val:n}},function(t,e,r){"use strict";function n(t,e){var r=e.exec(t);return!(null==r)}e.isExist=function(t){return void 0!==t},e.isEmptyObject=function(t){return 0===Object.keys(t).length},e.merge=function(t,e,r){if(e)for(var n=Object.keys(e),i=n.length,o=0;o<i;o++)t[n[o]]="strict"===r?[e[n[o]]]:e[n[o]]},e.getValue=function(t){return e.isExist(t)?t:""},e.buildOptions=function(t,e,r){var n={};if(!t)return e;for(var i=0;i<r.length;i++)void 0!==t[r[i]]?n[r[i]]=t[r[i]]:n[r[i]]=e[r[i]];return n},e.doesMatch=n,e.doesNotMatch=function(t,e){return!n(t,e)},e.getAllMatches=function(t,e){for(var r=[],n=e.exec(t);n;){for(var i=[],o=n.length,a=0;a<o;a++)i.push(n[a]);r.push(i),n=e.exec(t)}return r}},function(t,e,r){"use strict";var f=r(9),h=r(9).buildOptions,d=r(11),y={OPENING:1,CLOSING:2,SELF:3,CDATA:4},v="<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|(([\\w:\\-._]*:)?([\\w:\\-._]+))([^>]*)>|((\\/)(([\\w:\\-._]*:)?([\\w:\\-._]+))\\s*>))([^<]*)";!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);var p={attributeNamePrefix:"@_",attrNodeName:!1,textNodeName:"#text",ignoreAttributes:!0,ignoreNameSpace:!1,allowBooleanAttributes:!1,parseNodeValue:!0,parseAttributeValue:!1,arrayMode:!1,trimValues:!0,cdataTagName:!1,cdataPositionChar:"\\c",localeRange:"",tagValueProcessor:function(t){return t},attrValueProcessor:function(t){return t},stopNodes:[]};e.defaultOptions=p;var g=["attributeNamePrefix","attrNodeName","textNodeName","ignoreAttributes","ignoreNameSpace","allowBooleanAttributes","parseNodeValue","parseAttributeValue","arrayMode","trimValues","cdataTagName","cdataPositionChar","localeRange","tagValueProcessor","attrValueProcessor","parseTrueNumberOnly","stopNodes"];e.props=g;function m(t,e,r){var n=t[7]||r,i=t[14];return i&&(e.trimValues&&(i=i.trim()),i=s(i=e.tagValueProcessor(i,n),e.parseNodeValue,e.parseTrueNumberOnly)),i}function b(t){return"]]>"===t[4]?y.CDATA:"/"===t[10]?y.CLOSING:void 0!==t[8]&&"/"===t[8].substr(t[8].length-1)?y.SELF:y.OPENING}function u(t,e){if(e.ignoreNameSpace){var r=t.split(":"),n="/"===t.charAt(0)?"/":"";if("xmlns"===r[0])return"";2===r.length&&(t=n+r[1])}return t}function s(t,e,r){var n;return e&&"string"==typeof t?(""===t.trim()||isNaN(t)?n="true"===t||"false"!==t&&t:(n=-1!==t.indexOf("0x")?Number.parseInt(t,16):-1!==t.indexOf(".")?Number.parseFloat(t):Number.parseInt(t,10),r&&(n=String(n)===t?n:t)),n):f.isExist(t)?t:""}var c=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])(.*?)\\3)?","g");function w(t,e){if(!e.ignoreAttributes&&"string"==typeof t){t=t.replace(/\r?\n/g," ");for(var r=f.getAllMatches(t,c),n=r.length,i={},o=0;o<n;o++){var a=u(r[o][1],e);a.length&&(void 0!==r[o][4]?(e.trimValues&&(r[o][4]=r[o][4].trim()),r[o][4]=e.attrValueProcessor(r[o][4],a),i[e.attributeNamePrefix+a]=s(r[o][4],e.parseAttributeValue,e.parseTrueNumberOnly)):e.allowBooleanAttributes&&(i[e.attributeNamePrefix+a]=!0))}if(!Object.keys(i).length)return;if(e.attrNodeName){var l={};return l[e.attrNodeName]=i,l}return i}}e.getTraversalObj=function(t,e){e=h(e,p,g),t=t.replace(/<!--[\s\S]*?-->/g,"");var r=new d("!xml"),n=r;v=v.replace(/\[\\w/g,"["+e.localeRange+"\\w");for(var i=new RegExp(v,"g"),o=i.exec(t),a=i.exec(t);o;){var l=b(o);if(l===y.CLOSING)n.parent&&o[14]&&(n.parent.val=f.getValue(n.parent.val)+""+m(o,e,n.parent.tagname)),e.stopNodes.length&&e.stopNodes.includes(n.tagname)&&(n.child=[],null==n.attrsMap&&(n.attrsMap={}),n.val=t.substr(n.startIndex+1,o.index-n.startIndex-1)),n=n.parent;else if(l===y.CDATA)if(e.cdataTagName){var u=new d(e.cdataTagName,n,o[3]);u.attrsMap=w(o[8],e),n.addChild(u),n.val=f.getValue(n.val)+e.cdataPositionChar,o[14]&&(n.val+=m(o,e))}else n.val=(n.val||"")+(o[3]||"")+m(o,e);else if(l===y.SELF){n&&o[14]&&(n.val=f.getValue(n.val)+""+m(o,e));var s=new d(e.ignoreNameSpace?o[7]:o[5],n,"");o[8]&&0<o[8].length&&(o[8]=o[8].substr(0,o[8].length-1)),s.attrsMap=w(o[8],e),n.addChild(s)}else{var c=new d(e.ignoreNameSpace?o[7]:o[5],n,m(o,e));e.stopNodes.length&&e.stopNodes.includes(c.tagname)&&(c.startIndex=o.index+o[1].length),c.attrsMap=w(o[8],e),n.addChild(c),n=c}o=a,a=i.exec(t)}return r}},function(t,e,r){"use strict";t.exports=function(t,e,r){this.tagname=t,this.parent=e,this.child={},this.attrsMap={},this.children=[],this.val=r,this.addChild=function(t){this.children.push(t),Array.isArray(this.child[t.tagname])?this.child[t.tagname].push(t):this.child[t.tagname]=[t]}}},function(t,e,r){"use strict";var p=r(9),g={allowBooleanAttributes:!1,localeRange:"a-zA-Z"},m=["allowBooleanAttributes","localeRange"];function b(t,e){for(var r=e;e<t.length;e++)if("?"==t[e]||" "==t[e]){var n=t.substr(r,e-r);if(5<e&&"xml"===n)return{err:{code:"InvalidXml",msg:"XML declaration allowed only at the start of the document."}};if("?"!=t[e]||">"!=t[e+1])continue;e++;break}return e}function w(t,e){if(t.length>e+5&&"-"===t[e+1]&&"-"===t[e+2]){for(e+=3;e<t.length;e++)if("-"===t[e]&&"-"===t[e+1]&&">"===t[e+2]){e+=2;break}}else if(t.length>e+8&&"D"===t[e+1]&&"O"===t[e+2]&&"C"===t[e+3]&&"T"===t[e+4]&&"Y"===t[e+5]&&"P"===t[e+6]&&"E"===t[e+7]){var r=1;for(e+=8;e<t.length;e++)if("<"===t[e])r++;else if(">"===t[e]&&0===--r)break}else if(t.length>e+9&&"["===t[e+1]&&"C"===t[e+2]&&"D"===t[e+3]&&"A"===t[e+4]&&"T"===t[e+5]&&"A"===t[e+6]&&"["===t[e+7])for(e+=8;e<t.length;e++)if("]"===t[e]&&"]"===t[e+1]&&">"===t[e+2]){e+=2;break}return e}e.validate=function(t,e){e=p.buildOptions(e,g,m);var r=[],n=!1;"\ufeff"===t[0]&&(t=t.substr(1));for(var i,o,a=new RegExp("^[_w][\\w\\-.:]*$".replace("_w","_"+e.localeRange)),l=new RegExp("^([w]|_)[\\w.\\-_:]*".replace("([w","(["+e.localeRange)),u=0;u<t.length;u++){if("<"!==t[u]){if(" "===t[u]||"\t"===t[u]||"\n"===t[u]||"\r"===t[u])continue;return{err:{code:"InvalidChar",msg:"char "+t[u]+" is not expected ."}}}if("?"===t[++u]){if((u=b(t,++u)).err)return u}else{if("!"===t[u]){u=w(t,u);continue}var s=!1;"/"===t[u]&&(s=!0,u++);for(var c="";u<t.length&&">"!==t[u]&&" "!==t[u]&&"\t"!==t[u]&&"\n"!==t[u]&&"\r"!==t[u];u++)c+=t[u];if("/"===(c=c.trim())[c.length-1]){c=c.substring(0,c.length-1);continue}if(i=c,o=l,p.doesNotMatch(i,o))return{err:{code:"InvalidTag",msg:"Tag "+c+" is an invalid name."}};var f=x(t,u);if(!1===f)return{err:{code:"InvalidAttr",msg:'Attributes for "'+c+'" have open quote.'}};var h=f.value;if(u=f.index,"/"===h[h.length-1]){var d=k(h=h.substring(0,h.length-1),e,a);if(!0!==d)return d;n=!0}else if(s){if(!f.tagClosed)return{err:{code:"InvalidTag",msg:'closing tag "'+c+"\" don't have proper closing."}};if(0<h.trim().length)return{err:{code:"InvalidTag",msg:'closing tag "'+c+"\" can't have attributes or invalid starting."}};var y=r.pop();if(c!==y)return{err:{code:"InvalidTag",msg:"closing tag "+y+" is expected inplace of "+c+"."}}}else{var v=k(h,e,a);if(!0!==v)return v;r.push(c),n=!0}for(u++;u<t.length;u++)if("<"===t[u]){if("!"!==t[u+1])break;u=w(t,++u)}"<"===t[u]&&u--}}return n?!(0<r.length)||{err:{code:"InvalidXml",msg:"Invalid "+JSON.stringify(r,null,4).replace(/\r?\n/g,"")+" found."}}:{err:{code:"InvalidXml",msg:"Start tag expected."}}};var o='"',a="'";function x(t,e){for(var r="",n="",i=!1;e<t.length;e++){if(t[e]===o||t[e]===a)if(""===n)n=t[e];else{if(n!==t[e])continue;n=""}else if(">"===t[e]&&""===n){i=!0;break}r+=t[e]}return""===n&&{value:r,index:e,tagClosed:i}}var s=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function k(t,e,r){for(var n,i,o=p.getAllMatches(t,s),a={},l=0;l<o.length;l++){if(0===o[l][1].length)return{err:{code:"InvalidAttr",msg:"attribute "+o[l][2]+" has no space in starting."}};if(void 0===o[l][3]&&!e.allowBooleanAttributes)return{err:{code:"InvalidAttr",msg:"boolean attribute "+o[l][2]+" is not allowed."}};var u=o[l][2];if(n=u,i=r,!p.doesMatch(n,i))return{err:{code:"InvalidAttr",msg:"attribute "+u+" is an invalid name."}};if(Object.prototype.hasOwnProperty.call(a,u))return{err:{code:"InvalidAttr",msg:"attribute "+u+" is repeated."}};a[u]=1}return!0}},function(t,e,r){"use strict";r.r(e),r.d(e,"default",function(){return i});r(6);var a=r(14);function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var l=new(r(4).default)("bitMapPool"),u=r(3),i=function(){function o(t,e,r){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var i=l.get(t);if(i)return i;this.config=r,this.chars=this.parseConfig(r),this.ready=!1,this.event=new u,this.texture=a.default.loadImage(e,function(){n.ready=!0,n.event.emit("text__load__done")}),l.set(t,this)}var t,e,r;return t=o,(e=[{key:"parseConfig",value:function(t){var e=(t=t.split("\r\n").join("\n")).split("\n"),r=this.getConfigByKey(e[3],"count");this.lineHeight=this.getConfigByKey(e[1],"lineHeight"),this.fontSize=this.getConfigByKey(e[0],"size"),console.log("font config",r,this.lineHeight,this.fontSize);for(var n={},i=4;i<4+r;i++){var o=e[i],a={};(n[String.fromCharCode(this.getConfigByKey(o,"id"))]=a).x=this.getConfigByKey(o,"x"),a.y=this.getConfigByKey(o,"y"),a.w=this.getConfigByKey(o,"width"),a.h=this.getConfigByKey(o,"height"),a.offX=this.getConfigByKey(o,"xoffset"),a.offY=this.getConfigByKey(o,"yoffset"),a.xadvance=this.getConfigByKey(o,"xadvance")}return console.log(n),n}},{key:"getConfigByKey",value:function(t,e){for(var r=t.split(" "),n=0,i=r.length;n<i;n++){var o=r[n];if(e===o.substring(0,e.length)){var a=o.substring(e.length+1);return parseInt(a)}}return 0}}])&&n(t.prototype,e),r&&n(t,r),o}()},function(t,e,r){"use strict";r.r(e);var n=r(4),o=r(6);function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=new n.default("imgPool"),l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,n;return e=t,(r=[{key:"getRes",value:function(t){return a.get(t)}},{key:"loadImage",value:function(t,e){var r=1<arguments.length&&void 0!==e?e:o.none,n=null,i=this.getRes(t);return t&&(i&&i.loadDone?(n=i,r()):i&&!i.loadDone?(n=i).onloadcbks.push(r):((n=Object(o.createImage)()).onloadcbks=[r],a.set(t,n),n.onload=function(){n.onloadcbks.forEach(function(t){return t()}),n.onloadcbks=[],n.loadDone=!0},n.onerror=function(t){console.log("img load error",t)},n.src=t)),n}}])&&i(e.prototype,r),n&&i(e,n),t}();e.default=new l},function(t,e,r){"use strict";r.r(e);var n=r(16);r.d(e,"View",function(){return n.default});var i=r(17);r.d(e,"Image",function(){return i.default});var o=r(18);r.d(e,"Text",function(){return o.default});var a=r(19);r.d(e,"ScrollView",function(){return a.default});var l=r(21);r.d(e,"BitMapText",function(){return l.default})},function(t,e,r){"use strict";r.r(e),r.d(e,"default",function(){return s});var n=r(1);function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(o){return function(){var t,e,r,n=l(o);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var i=l(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return e=this,!(r=t)||"object"!==a(r)&&"function"!=typeof r?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):r}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var s=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(f,n["default"]);var t,e,r,c=o(f);function f(t){var e,r=t.style,n=void 0===r?{}:r,i=t.props,o=void 0===i?{}:i,a=t.idName,l=void 0===a?"":a,u=t.className,s=void 0===u?"":u;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=c.call(this,{props:o,idName:l,className:s,style:n})).type="View",e.ctx=null,e.renderBoxes=[],e}return t=f,(e=[{key:"destroySelf",value:function(){this.isDestroyed=!0,this.children=null}},{key:"checkNeedRender",value:function(){var t=this.style||{},e=t.borderColor;return!!(t.backgroundColor||t.borderWidth&&e||t.borderTopWidth&&(e||t.borderTopColor)||t.borderBottomWidth&&(e||t.borderBottomColor)||t.borderLeftWidth&&(e||t.borderLeftColor)||t.borderRightWidth&&(e||t.borderRightColor))}},{key:"render",value:function(t,e){var r=this.style||{},n=e||this.layoutBox;t.save();var i=r.borderWidth||0,o=n.absoluteX,a=n.absoluteY,l=r.borderLeftWidth||i,u=r.borderRightWidth||i,s=r.borderTopWidth||i,c=r.borderBottomWidth||i;this.renderBorder(t,e),r.backgroundColor&&(t.fillStyle=r.backgroundColor,t.fillRect(o+l,a+u,n.width-(l+u),n.height-(s+c))),t.restore()}},{key:"insert",value:function(t,e){this.ctx=t,e=e||this.layoutBox,this.renderBoxes.push({ctx:t,box:e}),this.render(t,e)}},{key:"repaint",value:function(){var e=this;this.renderBoxes.forEach(function(t){e.render(t.ctx,t.box)})}}])&&i(t.prototype,e),r&&i(t,r),f}()},function(t,e,r){"use strict";r.r(e),r.d(e,"default",function(){return f});var n=r(1),i=r(6);function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(o){return function(){var t,e,r,n=u(o);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var i=u(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return e=this,!(r=t)||"object"!==a(r)&&"function"!=typeof r?y(e):r}}function y(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var c=new(r(4).default)("imgPool"),f=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(d,n["default"]);var t,e,r,h=l(d);function d(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d);var r=t.style,n=void 0===r?{}:r,i=t.props,o=void 0===i?{}:i,a=t.idName,l=void 0===a?"":a,u=t.className,s=void 0===u?"":u,c=t.src,f=void 0===c?"":c;return(e=h.call(this,{props:o,idName:l,className:s,style:n})).imgsrc=f,Object.defineProperty(y(e),"src",{get:function(){return this.imgsrc},set:function(t){var e=this;t!==this.imgsrc&&(this.imgsrc=t,this.initImg(function(){e.emit("repaint")}))},enumerable:!0,configurable:!0}),e.type="Image",e.renderBoxes=[],e}return t=d,(e=[{key:"repaint",value:function(){var e=this;this.renderBoxes.forEach(function(t){e.renderImg(t.ctx,t.box,!1)})}},{key:"destroySelf",value:function(){this.isDestroyed=!0,this.img&&(this.img.onloadcbks=[],this.img.onload=null,this.img.onerror=null),this.img=null,delete this.src,this.off("img__load__done")}},{key:"initImg",value:function(t){var e=this,r=0<arguments.length&&void 0!==t?t:i.none;this.img=null,this.imgLoadDone=!1;var n=c.get(this.src);if(!this.src)return this.imgLoadDone=!0,void r();n&&n.loadDone?(this.img=n,this.imgLoadDone=!0,r()):n&&!n.loadDone?(this.img=n).onloadcbks.push(function(){e.img&&(e.imgLoadDone=!0,e.emit("img__load__done"),r())}):(this.img=Object(i.createImage)(),this.img.onloadcbks=[],c.set(this.src,this.img),this.img.onload=function(){e.img&&(e.img&&(e.img.onloadcbks.forEach(function(t){return t()}),e.img.onloadcbks=[],e.img.loadDone=!0,e.imgLoadDone=!0),e.emit("img__load__done"),r())},this.img.onerror=function(t){console.log("img load error",t)},this.img.src=this.src)}},{key:"renderImg",value:function(t,e,r){var n=!(2<arguments.length&&void 0!==r)||r;if(this.img){var i=this.style||{},o=e||this.layoutBox;t.save(),i.borderColor&&(t.strokeStyle=i.borderColor),t.lineWidth=i.borderWidth||0;var a=o.absoluteX,l=o.absoluteY;this.renderBorder(t,e),t.drawImage(this.img,a,l,o.width,o.height),t.restore(),n&&this.EE.emit("image__render__done")}}},{key:"insert",value:function(t,e){var r=this;this.renderBoxes.push({ctx:t,box:e}),this.initImg(function(){r.renderImg(t,e)})}}])&&o(t.prototype,e),r&&o(t,r),d}()},function(t,e,r){"use strict";r.r(e),r.d(e,"default",function(){return d});var n=r(1),i=r(6);function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(o){return function(){var t,e,r,n=u(o);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var i=u(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return e=this,!(r=t)||"object"!==a(r)&&"function"!=typeof r?y(e):r}}function y(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var c="PingFangSC-Regular, sans-serif",f=null,h=function(){if(f)return f;var t=Object(i.createCanvas)();return t.width=1,t.height=1,f=t.getContext("2d")};function v(t,e){var r=h();return r.font="".concat(t.fontWeight||"normal"," ").concat(t.fontSize||12,"px ").concat(t.fontFamily||c),r.measureText(e).width||0}function p(t){return h().measureText(t).width||0}var d=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(d,n["default"]);var t,e,r,h=l(d);function d(t){var e,r=t.style,n=void 0===r?{}:r,i=t.props,o=void 0===i?{}:i,a=t.idName,l=void 0===a?"":a,u=t.className,s=void 0===u?"":u,c=t.value,f=void 0===c?"":c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),void 0===n.width?n.width=v(n,f):"ellipsis"===n.textOverflow&&(f=function(t,e){e=String(e);var r=t.width,n=v(t,e),i=t.textOverflow||"ellipsis";if(n<=r)return e;"ellipsis"===i&&(r-=p("..."));for(var o=e.length-1,a=e.substring(0,o);p(a)>r&&0<o;)o--,a=e.substring(0,o);return o&&"ellipsis"===i?a+"...":a}(n,f)),(e=h.call(this,{props:o,idName:l,className:s,style:n})).type="Text",e.ctx=null,e.valuesrc=f,e.renderBoxes=[],Object.defineProperty(y(e),"value",{get:function(){return this.valuesrc},set:function(t){t!==this.valuesrc&&(this.valuesrc=t,this.emit("repaint"))},enumerable:!0,configurable:!0}),e}return t=d,(e=[{key:"toCanvasData",value:function(){var t=this.style||{};this.fontSize=t.fontSize||12,this.textBaseline="top",this.font="".concat(t.fontWeight||""," ").concat(t.fontSize||12,"px ").concat(c),this.textAlign=t.textAlign||"left",this.fillStyle=t.color||"#000"}},{key:"insert",value:function(t,e){this.renderBoxes.push({ctx:t,box:e}),this.render(t,e)}},{key:"repaint",value:function(){var e=this;this.renderBoxes.forEach(function(t){e.render(t.ctx,t.box)})}},{key:"render",value:function(t,e){this.toCanvasData(),t.save();var r=e||this.layoutBox,n=this.style;t.textBaseline=this.textBaseline,t.font=this.font,t.textAlign=this.textAlign;var i=r.absoluteX,o=r.absoluteY;this.renderBorder(t,e),n.backgroundColor&&(t.fillStyle=n.backgroundColor,t.fillRect(i,o,r.width,r.height)),t.fillStyle=this.fillStyle,"center"===this.textAlign?i+=r.width/2:"right"===this.textAlign&&(i+=r.width),n.lineHeight&&(t.textBaseline="middle",o+=n.lineHeight/2),t.fillText(this.value,i,o),t.restore()}}])&&o(t.prototype,e),r&&o(t,r),d}()},function(t,e,r){"use strict";r.r(e),r.d(e,"default",function(){return s});var n=r(16),i=r(4),c=r(20),f=r(6);function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(o){return function(){var t,e,r,n=u(o);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var i=u(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return e=this,!(r=t)||"object"!==a(r)&&"function"!=typeof r?h(e):r}}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var y=0,v=new i.default("canvasPool"),s=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(s,n["default"]);var t,e,r,u=l(s);function s(t){var e,r=t.style,n=void 0===r?{}:r,i=t.props,o=void 0===i?{}:i,a=t.name,l=void 0===a?"":a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(e=u.call(this,{props:o,name:l,style:n})).type="ScrollView",e.top=0,e.touch=new c.default,e.pageHeight=2e3,e.pageCount=1,e.canvasMap={},e.throttleRepaint=Object(f.throttle)(e.clipRepaint,16,h(e)),e.renderTimers=[],e}return t=s,(e=[{key:"initRepaint",value:function(){var t=this;this.on("repaint",function(){t.clear(),t.repaint(),t.clipRepaint(-t.top)})}},{key:"clear",value:function(){var r=this;Object.keys(this.canvasMap).forEach(function(t){var e=r.canvasMap[t];e.context&&e.context.clearRect(0,0,e.canvas.width,e.canvas.height)})}},{key:"repaint",value:function(t){var r=this,n=(t=t||this).children;Object.keys(n).forEach(function(t){var e=n[t];e.repaint(),r.repaint(e)})}},{key:"updateRenderPort",value:function(t){this.renderport=t}},{key:"calPageData",value:function(){this.pageCount=Math.ceil((this.scrollHeight+this.layoutBox.absoluteY)/this.pageHeight);for(var t=0;t<this.pageCount;t++){var e=v.get(t);e?(e.context&&e.context.clearRect(0,0,e.canvas.width,e.canvas.height),e.elements=[],this.canvasMap[t]=e):(this.canvasMap[t]={elements:[]},v.set(t,this.canvasMap[t]))}}},{key:"destroySelf",value:function(){this.touch=null,this.isDestroyed=!0,this.throttleRepaint=null,this.renderTimers.forEach(function(t){clearTimeout(t)}),this.renderTimers=[],this.canvasMap={},this.ctx=null,this.children=null}},{key:"clipRepaint",value:function(t){if(!this.isDestroyed){t=-t,this.top=t;var e=this.layoutBox,r=e.absoluteY;if(!this.isDestroyed&&this.root.state!==f.STATE.CLEAR){this.ctx.clearRect(e.absoluteX,r,e.width,e.height),this.ctx.fillStyle=this.parent.style.backgroundColor||"#ffffff",this.ctx.fillRect(e.absoluteX,r,e.width,e.height);for(var n=0;n<this.pageCount;n++){var i=this.canvasMap[n].canvas,o=r+t,a=r+t+e.height;if(o<this.pageHeight*(n+1)&&a>this.pageHeight*n){var l=r+t-this.pageHeight*n,u=e.height,s=r;0<l&&this.pageHeight-l<e.height?u=this.pageHeight-l:l<0&&(u=l+e.height,s-=l,l=0),this.ctx.drawImage(i,e.absoluteX,l,e.width,u,e.absoluteX,s,e.width,u)}}}}}},{key:"renderChildren",value:function(t){var a=this,l=t.children,u=this.pageHeight;Object.keys(l).forEach(function(t){var e=l[t],r=e.layoutBox.originalAbsoluteY,n=Math.floor(r/u),i=n+1;if(e.layoutBox.absoluteY-=a.pageHeight*n,e.checkNeedRender()&&a.canvasMap[n].elements.push({element:e,box:e.layoutBox}),r+e.layoutBox.height>u*i){var o=Object.assign({},e.layoutBox);o.absoluteY=r-a.pageHeight*i,e.checkNeedRender()&&a.canvasMap[i].elements.push({element:e,box:o})}a.renderChildren(e)})}},{key:"insertElements",value:function(t){var e=this,r=Object(f.createCanvas)(),n=r.getContext("2d");if(r.width=this.renderport.width,r.height=this.pageHeight,n.id=++y,this.canvasMap[t].canvas=r,this.canvasMap[t].context=n,this.canvasMap[t].elements.forEach(function(t){t.element.insert(n,t.box)}),t<this.pageCount-1){var i=setTimeout(function(){e.insertElements(++t)},250);this.renderTimers.push(i)}}},{key:"insertScrollView",value:function(t){var e=this;this.insert(t),this.calPageData(),this.renderChildren(this),this.insertElements(0),this.clipRepaint(-this.top),this.EE.on("image__render__done",function(){e.throttleRepaint(-e.top||0)}),this.scrollHeight>this.layoutBox.height&&(this.touch.setTouchRange(-(this.scrollHeight-this.layoutBox.height),0,this.clipRepaint.bind(this)),this.on("touchstart",this.touch.startFunc),this.on("touchmove",this.touch.moveFunc),this.on("touchend",this.touch.endFunc))}},{key:"scrollHeight",get:function(){var t=this.children[this.children.length-1];return t.layoutBox.top+t.layoutBox.height}}])&&o(t.prototype,e),r&&o(t,r),s}()},function(t,e,r){"use strict";r.r(e),r.d(e,"default",function(){return a});var n=r(6);function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var o=Object(n.getDpr)(),a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.needProcess=!1,this.startFunc=this.touchStartHandler.bind(this),this.endFunc=this.touchEndHandler.bind(this),this.moveFunc=this.touchMoveHandler.bind(this)}var e,r,n;return e=t,(r=[{key:"reset",value:function(){this.touchTime=new Date,this.touchStartX=0,this.touchStartY=0,this.start=0,this.end=0,this.move=0,this.target=0,this.scroll=null,"undefined"!=typeof cancelAnimationFrame&&cancelAnimationFrame(this.animate)}},{key:"enable",value:function(){this.reset(),this.needProcess=!0}},{key:"disable",value:function(){this.needProcess=!1}},{key:"setTouchRange",value:function(t,e,r){this.enable(),this.start=t,this.end=e,0===t&&0===e||(this.scroll=r)}},{key:"limitTarget",value:function(t){var e=t;return t>this.end?e=this.end:t<this.start&&(e=this.start),e}},{key:"touchStartHandler",value:function(t){var e=t.touches&&t.touches[0]||t.changedTouches&&t.changedTouches[0]||t;e&&e.pageX&&e.pageY&&(this.touchStartX=e.clientX*o,this.touchStartY=e.clientY*o,this.touchTime=new Date,this.isMoving=!0,this.needProcess=!0,this.animate=requestAnimationFrame(this.loop.bind(this)))}},{key:"touchMoveHandler",value:function(t){if(this.isMoving){var e=t.touches&&t.touches[0]||t.changedTouches&&t.changedTouches[0]||t;if(e&&e.pageX&&e.pageY){var r=e.clientY*o;(2<this.touchStartY-r||this.touchStartY-r<-2)&&(this.target-=this.touchStartY-r),this.target=this.limitTarget(this.target),this.touchStartY=r}}}},{key:"touchEndHandler",value:function(){this.isMoving=!1;var t=(Date.now()-this.touchTime)/1e3;t<.9&&(this.target+=.6*(this.target-this.move)/(5*t),this.target=this.limitTarget(this.target))}},{key:"loop",value:function(){this.needProcess?(this.isMoving?this.move!==this.target&&(1<Math.abs(this.target-this.move)?this.move+=.4*(this.target-this.move):this.move=this.target,this.scroll&&this.scroll(this.move)):this.move!==this.target?(1<Math.abs(this.target-this.move)?this.move+=.3*(this.target-this.move):this.move=this.target,this.scroll&&this.scroll(this.move)):this.needProcess=!1,this.animate=requestAnimationFrame(this.loop.bind(this))):"undefined"!=typeof cancelAnimationFrame&&cancelAnimationFrame(this.animate)}}])&&i(e.prototype,r),n&&i(e,n),t}()},function(t,e,r){"use strict";r.r(e),r.d(e,"default",function(){return s});var n=r(1);r(5),r(13);function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(o){return function(){var t,e,r,n=l(o);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return;if(Reflect.construct.sham)return;if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),1}catch(t){return}}()){var i=l(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return e=this,!(r=t)||"object"!==a(r)&&"function"!=typeof r?p(e):r}}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var g=new(r(4).default)("bitMapPool"),s=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(v,n["default"]);var t,e,r,y=o(v);function v(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,v);var r=t.style,n=void 0===r?{}:r,i=t.props,o=void 0===i?{}:i,a=t.idName,l=void 0===a?"":a,u=t.className,s=void 0===u?"":u,c=t.value,f=void 0===c?"":c,h=t.font,d=void 0===h?"":h;return(e=y.call(this,{props:o,idName:l,className:s,style:n})).type="BitMapText",e.ctx=null,e.valuesrc=f,e.renderBoxes=[],Object.defineProperty(p(e),"value",{get:function(){return this.valuesrc},set:function(t){t!==this.valuesrc&&(this.valuesrc=t,this.emit("repaint"))},enumerable:!0,configurable:!0}),e.font=g.get(d),e.font||console.error("Please invoke API `registBitMapFont` before using `BitMapText`"),e}return t=v,(e=[{key:"insert",value:function(t,e){this.renderBoxes.push({ctx:t,box:e}),this.render(t,e)}},{key:"repaint",value:function(){var e=this;this.renderBoxes.forEach(function(t){e.render(t.ctx,t.box)})}},{key:"render",value:function(t,e){var r=this;this.font&&(this.font.ready?this.renderText(t,e):this.font.event.on("text__load__done",function(){r.renderText(t,e)}))}},{key:"getTextBounds",value:function(){for(var t=this.style.letterSpacing,e=void 0===t?0:t,r=0,n=0,i=this.value.length;n<i;n++){var o=this.value[n],a=this.font.chars[o];a&&(r+=a.w,n<i-1&&(r+=e))}return{width:r,height:this.font.lineHeight}}},{key:"renderText",value:function(t,e){var r=this.getTextBounds(),n=this.font.lineHeight;t.save(),this.renderBorder(t,e);var i=e||this.layoutBox,o=this.style,a=o.width,l=o.height,u=o.lineHeight,s=void 0===u?n:u,c=o.textAlign,f=(o.textBaseline,o.verticalAlign),h=i.absoluteX,d=i.absoluteY,y=s/n,v=y*r.width;s<l&&("middle"===f?d+=(l-s)/2:"bottom"===f&&(d=d+l-s)),v<a&&("center"===c?h+=(a-v)/2:"right"===c&&(h+=a-v));for(var p=0;p<this.value.length;p++){var g=this.value[p],m=this.font.chars[g];m&&(t.drawImage(this.font.texture,m.x,m.y,m.w,m.h,h+m.offX*y,d+m.offY*y,m.w*y,m.h*y),h+=m.w*y)}}}])&&i(t.prototype,e),r&&i(t,r),v}()}]);